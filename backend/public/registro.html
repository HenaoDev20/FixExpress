<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
  <title>Registro de Usuario</title>
</head>
<body>
  <main class="registro-container">
    <section class="registro-formulario">
      <h1>Crear Cuenta</h1>

      <!--  Formulario sin action/method -->
      <form id="formRegistro">
        <div class="campo">
          <label for="nombre">Nombre completo</label>
          <input type="text" id="nombre" name="nombre" placeholder="Ej: nombre completo" required>
        </div>

        <div class="campo">
          <label for="correo">Correo electrónico</label>
          <input type="email" id="correo" name="correo" placeholder="Ej: correo@" required>
        </div>

        <div class="campo">
          <label for="password">Contraseña</label>
          <input type="password" id="password" name="password" placeholder="Crea una contraseña segura" required>
        </div>

        <div class="campo">
          <label for="confirmar">Confirmar contraseña</label>
          <input type="password" id="confirmar" name="confirmar" placeholder="Repite tu contraseña" required>
        </div>

        <button type="submit" class="btn-registrar">Registrarse</button>

        <p class="login-link">
          ¿Ya tienes cuenta? <a href="login.html">Inicia sesión</a>
        </p>
      </form>
    </section>
  </main>

  <!--  Script para manejar registro y redirigir -->
  <script>
    const form = document.getElementById('formRegistro');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const datos = {
        nombre: form.nombre.value,
        correo: form.correo.value,
        password: form.password.value,
        confirmar: form.confirmar.value
      };

      try {
        const respuesta = await fetch('/registro', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(datos)
        });

        const resultado = await respuesta.text();
        console.log('Respuesta del servidor:', resultado);

        if (respuesta.ok) {
          alert(' Registro exitoso. Serás redirigido al login.');
          window.location.href = 'login.html';
        } else {
          alert(' Error: ' + resultado);
        }
      } catch (error) {
        console.error(' Error en el envío del formulario:', error);
        alert('No se pudo conectar con el servidor.');
      }
    });
  </script>
</body>
</html>
